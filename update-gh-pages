#!/usr/bin/env zsh

SOURCES=(*.markdown)
PAGES=(${SOURCES/%.markdown/.html})

echo "Building $PAGES."

git checkout gh-pages       &&
git clean -fx               &&
git merge --no-edit master  &&
rm -f $PAGES                &&
redo                        &&
if git commit --porcelain --all | grep -q '^M '; then
    git commit -a -m "Update HTML." &&
    git push
else
    echo No changes, skipping push.
fi

git checkout master
